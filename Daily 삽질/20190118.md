
오늘은 vSphere 와의 Single Sign-On 구현을 위해 고군분투 중.
요건은 vCenter 서버와 API 수집기 서버 간의 통신이 암호화되어야 한다는 것이다.
https 통신을 위한 서버 설정을 했었음에도 SSL을 이용한 통신에 대해서 정확히 알지 못했다.

근데 그러면 연결하고자 하는 모든 vSphere 서버에 내 공개키를 넣어줘야 통신을 할 수 있다는 거잖아?


1. 인증서의 기능
- 클라이언트가 접속한 서버가 신뢰 할 수 있는 서버임을 보장한다.
- SSL 통신에 사용할 공개키를 클라이언트에게 제공한다.
  ---> 서버가 클라이언트한테 공개키를 줘야 한다.

CA: 얘 믿을 수 있는 서버야! 라고 인증해주는 기관

인증서(cert): 
- 서비스의 정보 (인증서를 발급한 CA, 서비스의 도메인 등등)
- 서버 측 공개키 (공개키의 내용, 공개키의 암호화 방법)



2. 세션과 쿠키
2.1. 세션
일정 시간동안 같은 브라우저로 부터 들어오는 일련의 요구를 하나의 상태로 보고 그 상태를 유지하는 기술
클라이언트가 Request를 보내면, 해당 서버의 엔진이 클라이언트에게 유일한 ID를 부여하는 데 이것이 세션ID다.

1. 클라이언트가 서버에 접속시 세션 ID를 발급
2. 서버에서는 클라이언트로 발급해준 세션 ID를 쿠키를 사용해 저장 (JSESSIONID)
3. 클라이언트는 다시 접속할 때, 이 쿠키(JSESSIONID)를 이용해서 세션ID 값을 서버에 전달

즉, 세션을 구별하기 위해 ID가 필요하고 그 ID만 쿠키를 이용해서 저장해놓는다. 쿠키는 자동으로 서버에 전송되니까 서버에서 세션아이디에 따른 처리를 할 수 있음.

2.2. 쿠키
쿠키는 클라이언트 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일. 이름, 값, 만료날짜(쿠키 저장기간), 경로 정보가 들어있다.
쿠키는 클라이언트의 상태 정보를 로컬에 저장했다가 참조한다.
자동로그인, 팝업에서 "오늘 더 이상 이 창을 보지 않음" 체크, 쇼핑몰의 장바구니에 사용됨.


2.3. 쿠키와 세션의 차이
* 저장 위치: 쿠키는 클라이언트에 파일로 저장, 세션은 서버에 저장
* 보안: 쿠키는 클라이언트 로컬에 저장되기 때문에 변질되거나 request에서 스나이핑 당할 우려가 있어서 보안에 취약하지만, 세션은 쿠키를 이용해서 sessionid 만 저장하고 서버에서 처리하기 때문에 비교적 보안성이 좋다.
* 라이프 사이클: 쿠키도 만료시간이 있지만 파일로 저장되기 때문에 브라우저를 종료해도 계속해서 정보가 남아 있을 수 있다. 또한 만료기간을 넉넉하게 잡아두면 쿠키 삭제를 할 때 까지 유지될 수도 있다. 반면에 세션도 만료시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제된다.
* 속도: 쿠키가 서버에 다녀오는 세션 보다 더 빠름.

* 세션은 서버의 자원을 사용하기때문에 무분별하게 만들다보면 서버의 메모리가 감당할 수 없어질 수가 있고 속도가 느려질 수 있기 때문이다.

reference: https://jeong-pro.tistory.com/80

